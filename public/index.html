<!DOCTYPE html>
<html>

<head>
  <title>Simple Chat</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    
    #chat {
      border: 1px dubble #ccc;
      height: 400px;
      overflow-y: auto;
      padding: 10px;
      margin-bottom: 10px;
    }
    
    .me {
      color: blue;
      text-align: right;
      margin: 8px 0;
    }
    
    .user {
      color: green;
      text-align: left;
      margin: 8px 0;
    }
    
    .system {
      color: gray;
      text-align: center;
      font-style: italic;
    }
  </style>
</head>

<body>
  
  <h3>Chat App (Room ID: <span id="myId">connecting...</span>)</h3>
  
  <div id="chat"></div>
  
  <input type="text" id="text" placeholder="Type message..." style="width:70%;" />
  <button onclick="sendMessage()">Send</button>
  <script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();   // অটো কানেক্ট করে (ws://localhost:3000)

  const chat = document.getElementById('chat');
  const input = document.getElementById('text');

  function addMsg(text, className = 'system') {
    const p = document.createElement('p');
    p.textContent = text;
    p.className = className;
    chat.appendChild(p);
    chat.scrollTop = chat.scrollHeight;
  }

  socket.on('connect', () => {
    addMsg('Connected ✓', 'system');

document.getElementById('myId').textContent="connected"

  });

  socket.on('chat message', (data) => {
    const isMe = data.from === socket.id.slice(0,6);
    addMsg(`${isMe ? 'You' : 'User ' + data.from}: ${data.text}`, isMe ? 'me' : 'user');
  });

  socket.on('user-joined', addMsg);
  socket.on('user-left', addMsg);

  function sendMessage() {
    const text = input.value.trim();
    if (text) {
      socket.emit('chat message', text);
      input.value = '';
    }
  }

  input.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') sendMessage();
  });
</script>

</body>

</html>
